
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>t_codeRendering</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-02-23"><meta name="DC.source" content="t_codeRendering.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>t_codeRendering</h1><!--introduction--><p>Show radiance and irradiance data as RGB images.</p><p>ISETBIO stores spectral power distributions of the radiance and irradiance images (and illuminants). The display rendering maps the spectral data into RGB using a simple principle</p><pre>  Convert the radiance/irradiance data to CIE XYZ values
  Convert the XYZ values to sRGB data appropriate for display</pre><p>This tutorial shows these functions in action.</p><p>NOTES:     sRGB coordinates are obtained from XYZ based on a "standard" model of typical monitor performance.     Real monitors will deviate from the sRGB standard, and for real monitors you can do better if you use     calibration data for that monitor. But this isn't illustrated here.</p><p>Copyright Imageval Consulting, LLC 2013</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Initialize</a></li><li><a href="#2">Create a yellowsh blackbody spectrum</a></li><li><a href="#3">C%%onvert the spd into an sRGB value</a></li><li><a href="#4">3D Format for images</a></li><li><a href="#5">Here is a bluish blackbody radiator</a></li><li><a href="#6">End</a></li></ul></div><h2>Initialize<a name="1"></a></h2><pre class="codeinput">ieInit;
</pre><h2>Create a yellowsh blackbody spectrum<a name="2"></a></h2><pre class="codeinput"><span class="comment">% Here is a simple vector of a yellowsh SPD</span>
wave = 400:10:700;   <span class="comment">% Specify the wavelength samples</span>
spd = blackbody(wave,3000);

vcNewGraphWin; plot(wave,spd);
xlabel(<span class="string">'Wavelength (nm)'</span>);
ylabel(<span class="string">'Energy (watts/sr/m2/nm)'</span>);
grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="t_codeRendering_01.png" alt=""> <h2>C%%onvert the spd into an sRGB value<a name="3"></a></h2><pre class="codeinput"><span class="comment">% We calculate the XYZ values from the spd</span>
XYZ = ieXYZFromEnergy(spd',wave);

<span class="comment">% We want the data to be in (row,col,wave) format</span>
XYZ = XW2RGBFormat(XYZ,1,1);

<span class="comment">% We then convert this to sRGB</span>
sRGB = xyz2srgb(XYZ);

vcNewGraphWin;
imagesc(sRGB)
axis <span class="string">off</span>; axis <span class="string">image</span>
</pre><img vspace="5" hspace="5" src="t_codeRendering_02.png" alt=""> <h2>3D Format for images<a name="4"></a></h2><pre class="codeinput"><span class="comment">% We treat represent images using a 3D format (row,col,channels)</span>
<span class="comment">% RGB images have three channels.  SPD images have more channels, equal to</span>
<span class="comment">% the number of wavelength samples.</span>

<span class="comment">% We convert a vector into the 3D format (which we call RGBFormat) as</span>
<span class="comment">% follows.</span>
vcNewGraphWin;
spd3D = XW2RGBFormat(spd(:)',1,1);

<span class="comment">% The spd3D has only one spatial point, which is hard to see.  So, let's</span>
<span class="comment">% make it bigger</span>
spd3D = imageIncreaseImageRGBSize(spd3D,40);
imageSPD(spd3D,wave);
</pre><img vspace="5" hspace="5" src="t_codeRendering_03.png" alt=""> <h2>Here is a bluish blackbody radiator<a name="5"></a></h2><pre class="codeinput">spd   = blackbody(wave,8000);
spd3D = XW2RGBFormat(spd',1,1);

<span class="comment">% It is only one point, which is hard to see.  So, let's make it bigger</span>
spd3D = imageIncreaseImageRGBSize(spd3D,40);
imageSPD(spd3D,wave);
</pre><img vspace="5" hspace="5" src="t_codeRendering_04.png" alt=""> <h2>End<a name="6"></a></h2><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% t_codeRendering
%
% Show radiance and irradiance data as RGB images.
%
% ISETBIO stores spectral power distributions of the radiance and
% irradiance images (and illuminants). The display rendering maps the
% spectral data into RGB using a simple principle
%
%    Convert the radiance/irradiance data to CIE XYZ values
%    Convert the XYZ values to sRGB data appropriate for display
%
% This tutorial shows these functions in action.
%
% NOTES:
%     sRGB coordinates are obtained from XYZ based on a "standard" model of typical monitor performance.
%     Real monitors will deviate from the sRGB standard, and for real monitors you can do better if you use
%     calibration data for that monitor. But this isn't illustrated here.
%
% Copyright Imageval Consulting, LLC 2013

%% Initialize
ieInit;

%% Create a yellowsh blackbody spectrum

% Here is a simple vector of a yellowsh SPD
wave = 400:10:700;   % Specify the wavelength samples
spd = blackbody(wave,3000);

vcNewGraphWin; plot(wave,spd);
xlabel('Wavelength (nm)');
ylabel('Energy (watts/sr/m2/nm)');
grid on;

%% C%%onvert the spd into an sRGB value

% We calculate the XYZ values from the spd
XYZ = ieXYZFromEnergy(spd',wave);

% We want the data to be in (row,col,wave) format
XYZ = XW2RGBFormat(XYZ,1,1);

% We then convert this to sRGB
sRGB = xyz2srgb(XYZ);

vcNewGraphWin;
imagesc(sRGB)
axis off; axis image

%% 3D Format for images

% We treat represent images using a 3D format (row,col,channels)
% RGB images have three channels.  SPD images have more channels, equal to
% the number of wavelength samples. 

% We convert a vector into the 3D format (which we call RGBFormat) as
% follows.
vcNewGraphWin;
spd3D = XW2RGBFormat(spd(:)',1,1);

% The spd3D has only one spatial point, which is hard to see.  So, let's
% make it bigger
spd3D = imageIncreaseImageRGBSize(spd3D,40);
imageSPD(spd3D,wave);

%% Here is a bluish blackbody radiator
spd   = blackbody(wave,8000);
spd3D = XW2RGBFormat(spd',1,1);

% It is only one point, which is hard to see.  So, let's make it bigger
spd3D = imageIncreaseImageRGBSize(spd3D,40);
imageSPD(spd3D,wave);

%% End


##### SOURCE END #####
--></body></html>