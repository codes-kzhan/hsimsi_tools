
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>t_sceneIntroduction</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-03-06"><meta name="DC.source" content="t_sceneIntroduction.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>t_sceneIntroduction</h1><!--introduction--><p>An introduction to ISETBIO objects and functions: Scene</p><p>ISETBIO is structured around a few key objects that are important parts of the image acquisition pipeline. These are the scene, optical image, sensor, and image processor.</p><p>A main goal of this script is to illustrate the ISETBIO programming style. By using ISETBIO objects properly, the code and analysis are much easier to understand. The implementation of these objects was written before Matlab implemented its classes and thus doesn't rely on their organization.  But many of the principles are the same.</p><p>For each object there are three fundamental operations:  Create, set parameters, and get parameters.</p><p>This script introduces the first and simplest ISETBIO object: a scene. The scene describes the radiance field.  For the present tutorial we  work with a simple planar radiance image, such as the image on a display surface.  We have some implementations for 3D scenes that should be incorporated by mid-2014.</p><p>Notes:   A) Use t_TABCOMPLETION to see the list of ISETBIO tutorials</p><p>See also: t_oiIntroduction</p><p>Copyright ImagEval Consultants, LLC, 2011.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Initializing ISET</a></li><li><a href="#2">Create a scene and explore some of its features</a></li><li><a href="#3">The way to interact with an object is through gets and sets.</a></li><li><a href="#4">There are many other scene parameters you can get</a></li><li><a href="#5">Use sceneSet to change a scene property</a></li><li><a href="#6">Philosophical interlude - programming issues</a></li><li><a href="#7">More about gets and sets</a></li><li><a href="#8">Explore the relationship between parameters</a></li><li><a href="#9">You can change the distance and horizontal field of view (hFOV)</a></li><li><a href="#10">Specifying units</a></li><li><a href="#11">Creating a scene from a file</a></li><li><a href="#12">Plotting</a></li><li><a href="#13">You can change the illumination's spectral power distribution</a></li><li><a href="#14">ISETBIO keeps track of units</a></li></ul></div><h2>Initializing ISET<a name="1"></a></h2><p>While not necessary, initialization keeps the work space clean</p><pre class="codeinput">s_initISET;
</pre><h2>Create a scene and explore some of its features<a name="2"></a></h2><p>The create function initiates the object. Typically, there are many different initial formats. For the scene, the optics including color targets, patterns, charts, and images.</p><pre class="codeinput"><span class="comment">% ISET sceneCreate builds a number of predefined scenes</span>
<span class="comment">% You can see the range of possibilities by typing</span>
<span class="comment">%    help sceneCreate, or</span>
<span class="comment">%    doc sceneScreate</span>
<span class="comment">% into the Matlab prompt.</span>

<span class="comment">% Create a scene: Here is a simple scene of a color chart</span>
scene = sceneCreate(<span class="string">'macbeth d65'</span>);

<span class="comment">% To put the scene object into a window of the graphical user interface</span>
<span class="comment">% (GUI), first we use the command ISET that adds the scene to the ISET</span>
<span class="comment">% database:</span>
vcAddAndSelectObject(scene);

<span class="comment">% Then we call the function sceneWindow which displays the object This call</span>
<span class="comment">% opens the  graphical interface and displays the current scene</span>
sceneWindow;

<span class="comment">% When the window appears, you can scale the window size and adjust the</span>
<span class="comment">% font size as well (Edit | Change Font Size). There are many other options</span>
<span class="comment">% in the pull down menus for cropping, transposing, and measuring scene</span>
<span class="comment">% properties.</span>
</pre><img vspace="5" hspace="5" src="t_sceneIntroduction_01.png" alt=""> <h2>The way to interact with an object is through gets and sets.<a name="3"></a></h2><p>For example, each object has a name and a type.</p><pre class="codeinput">name = sceneGet(scene,<span class="string">'name'</span>)
</pre><pre class="codeoutput">
name =

Macbeth (D65)

</pre><h2>There are many other scene parameters you can get<a name="4"></a></h2><p>For example a scene has a horizontal field of view</p><pre class="codeinput">hFOV = sceneGet(scene,<span class="string">'hfov'</span>)
</pre><pre class="codeoutput">
hFOV =

    10

</pre><h2>Use sceneSet to change a scene property<a name="5"></a></h2><pre class="codeinput">scene = sceneSet(scene,<span class="string">'hfov'</span>,0.5);  <span class="comment">% In degrees of visual angle</span>

<span class="comment">% Confirm that the set worked</span>
hFOV = sceneGet(scene,<span class="string">'hfov'</span>)
</pre><pre class="codeoutput">
hFOV =

    0.5000

</pre><h2>Philosophical interlude - programming issues<a name="6"></a></h2><p>There are always more parameters to "get" than are to "set".  This is because there are dependencies among any object parameters.  For example, if you know the image distance and horizontal field of view, you can compute the spatial sample spacing.</p><p>In designing the sets/gets, the author must select an approach:  Do we allow the user to set anything and then update the other parameters for consistency, or do we only allow the user to set specific parameters and through this limitation enforce consistency.  ISETBIO uses the 2nd method: Only some parameters can be set.</p><p>That is why there are more gets than sets.  You can get parameters that depend on the sets.</p><p>You can see the scene structure and its parameters simply by typing</p><pre class="codeinput">scene
</pre><pre class="codeoutput">
scene = 

             type: 'scene'
             data: [1x1 struct]
         spectrum: [1x1 struct]
             name: 'Macbeth (D65)'
         distance: 1.2000
    magnification: 1
       illuminant: [1x1 struct]
         wAngular: 0.5000

</pre><h2>More about gets and sets<a name="7"></a></h2><p>While the objects in ISETBIO can be addressed directly - please don't. If you are ever tempted to set the objects directly, go get a cup of coffee.  When you come back, you will feel like using a sceneSet</p><pre class="codeinput"><span class="comment">% You can see the scene parameters you can set by typing</span>
<span class="comment">% help sceneSet</span>
<span class="comment">% For a nicer formatting, use the Matlab doc command</span>
<span class="comment">% For example, you might try</span>
<span class="comment">%   doc sceneGet</span>
<span class="comment">%   doc sceneSet</span>
</pre><h2>Explore the relationship between parameters<a name="8"></a></h2><p>To see an example of the dependence, consider the effect of scene distance, which we can get, on scene sample spacing.</p><pre class="codeinput">dist    = sceneGet(scene,<span class="string">'distance'</span>,<span class="string">'mm'</span>);
spacing = sceneGet(scene,<span class="string">'sample spacing'</span>,<span class="string">'mm'</span>);
dist

<span class="comment">%</span>
<span class="comment">% If we move the scene closer, and we maintain the same number of row and</span>
<span class="comment">% column samples, the spacing changes.</span>
scene = sceneSet(scene,<span class="string">'distance'</span>,0.6);
sceneGet(scene,<span class="string">'sample spacing'</span>,<span class="string">'mm'</span>);
</pre><pre class="codeoutput">
dist =

        1200

</pre><h2>You can change the distance and horizontal field of view (hFOV)<a name="9"></a></h2><p>This will change the sample spacing as well.</p><pre class="codeinput">scene = sceneSet(scene,<span class="string">'hfov'</span>,hFOV/2);
sceneGet(scene,<span class="string">'sample spacing'</span>,<span class="string">'mm'</span>)
</pre><pre class="codeoutput">
ans =

    0.0273    0.0273

</pre><h2>Specifying units<a name="10"></a></h2><p>In this example, we specified the units of the sample spacing as millimemters (mm). We could have specified microns.</p><pre class="codeinput">sceneGet(scene,<span class="string">'sample spacing'</span>,<span class="string">'um'</span>)

<span class="comment">% Or we could have specified the return in meters.</span>
sceneGet(scene,<span class="string">'sample spacing'</span>,<span class="string">'m'</span>)
</pre><pre class="codeoutput">
ans =

   27.2708   27.2708


ans =

   1.0e-04 *

    0.2727    0.2727

</pre><h2>Creating a scene from a file<a name="11"></a></h2><p>ISETBIO includes a few multispectral scenes.  These are large files, so the default distribution only includes one example.  We have another 100 or so that are available.</p><pre class="codeinput">fname = fullfile(isetRootPath,<span class="string">'data'</span>,<span class="string">'images'</span>,<span class="string">'multispectral'</span>,<span class="string">'stuffedAnimals_tungsten-hdrs.mat'</span>);
scene = sceneFromFile(fname,<span class="string">'multispectral'</span>);
vcAddAndSelectObject(scene); sceneWindow;
</pre><pre class="codeoutput">Reading multispectral data with mcCOEF.
Saved using svd method
</pre><img vspace="5" hspace="5" src="t_sceneIntroduction_02.png" alt=""> <h2>Plotting<a name="12"></a></h2><p>Many scene properties that can be plotted either from the scene Window or using plotScene. For example, ISETBIO scenes specify a uniform illuminant by default.  You can plot the illuminant in energy units by this command.</p><pre class="codeinput">plotScene(scene,<span class="string">'illuminant energy roi'</span>);

<span class="comment">% The plotScene command above is equivalent to</span>
<span class="comment">%  wave = sceneGet(scene,'wave');</span>
<span class="comment">%  illuminant  = sceneGet(scene,'illuminant energy');</span>
<span class="comment">%  vcNewGraphWin; plot(wave,illuminant); grid on</span>
<span class="comment">%  xlabel('wave (nm)'); ylabel('Energy (watts/sr/nm/m^2)')</span>
</pre><img vspace="5" hspace="5" src="t_sceneIntroduction_03.png" alt=""> <img vspace="5" hspace="5" src="t_sceneIntroduction_04.png" alt=""> <h2>You can change the illumination's spectral power distribution<a name="13"></a></h2><p>In this case, we create a blackbody illuminant and reilluminate the scene.</p><pre class="codeinput">bb = blackbody(sceneGet(scene,<span class="string">'wave'</span>),6500,<span class="string">'energy'</span>);
scene = sceneAdjustIlluminant(scene,bb);
vcReplaceAndSelectObject(scene); sceneWindow;
</pre><img vspace="5" hspace="5" src="t_sceneIntroduction_05.png" alt=""> <h2>ISETBIO keeps track of units<a name="14"></a></h2><p>In this case, we plot the illuminant in units of photons, rather than energy.</p><pre class="codeinput">plotScene(scene,<span class="string">'illuminant photons roi'</span>);
</pre><img vspace="5" hspace="5" src="t_sceneIntroduction_06.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% t_sceneIntroduction
%
% An introduction to ISETBIO objects and functions: Scene
%
% ISETBIO is structured around a few key objects that are important parts of
% the image acquisition pipeline. These are the scene, optical image,
% sensor, and image processor.
%
% A main goal of this script is to illustrate the ISETBIO programming style.
% By using ISETBIO objects properly, the code and analysis are much easier to
% understand. The implementation of these objects was written before Matlab
% implemented its classes and thus doesn't rely on their organization.  But
% many of the principles are the same.
%
% For each object there are three fundamental operations:  Create, set
% parameters, and get parameters.
%
% This script introduces the first and simplest ISETBIO object: a scene. The
% scene describes the radiance field.  For the present tutorial we  work
% with a simple planar radiance image, such as the image on a display
% surface.  We have some implementations for 3D scenes that should be
% incorporated by mid-2014.
%
% Notes:
%   A) Use t_TABCOMPLETION to see the list of ISETBIO tutorials
%
% See also: t_oiIntroduction
%
% Copyright ImagEval Consultants, LLC, 2011.

%% Initializing ISET
% While not necessary, initialization keeps the work space clean
s_initISET;

%% Create a scene and explore some of its features
% The create function initiates the object. Typically, there are many
% different initial formats. For the scene, the optics including color
% targets, patterns, charts, and images.

% ISET sceneCreate builds a number of predefined scenes
% You can see the range of possibilities by typing
%    help sceneCreate, or 
%    doc sceneScreate
% into the Matlab prompt.

% Create a scene: Here is a simple scene of a color chart
scene = sceneCreate('macbeth d65');

% To put the scene object into a window of the graphical user interface
% (GUI), first we use the command ISET that adds the scene to the ISET
% database:
vcAddAndSelectObject(scene);

% Then we call the function sceneWindow which displays the object This call
% opens the  graphical interface and displays the current scene
sceneWindow;

% When the window appears, you can scale the window size and adjust the
% font size as well (Edit | Change Font Size). There are many other options
% in the pull down menus for cropping, transposing, and measuring scene
% properties.

%% The way to interact with an object is through gets and sets.
% For example, each object has a name and a type.
name = sceneGet(scene,'name')

%% There are many other scene parameters you can get
% For example a scene has a horizontal field of view
hFOV = sceneGet(scene,'hfov')

%% Use sceneSet to change a scene property
scene = sceneSet(scene,'hfov',0.5);  % In degrees of visual angle

% Confirm that the set worked
hFOV = sceneGet(scene,'hfov')

%% Philosophical interlude - programming issues
% There are always more parameters to "get" than are to "set".  This is
% because there are dependencies among any object parameters.  For example,
% if you know the image distance and horizontal field of view, you can
% compute the spatial sample spacing.
%
% In designing the sets/gets, the author must select an approach:  Do we
% allow the user to set anything and then update the other parameters for
% consistency, or do we only allow the user to set specific parameters and
% through this limitation enforce consistency.  ISETBIO uses the 2nd method:
% Only some parameters can be set.
%
% That is why there are more gets than sets.  You can get parameters that
% depend on the sets.
%
% You can see the scene structure and its parameters simply by
% typing
scene

%% More about gets and sets
% While the objects in ISETBIO can be addressed directly - please don't.
% If you are ever tempted to set the objects directly, go get a cup of
% coffee.  When you come back, you will feel like using a sceneSet

% You can see the scene parameters you can set by typing
% help sceneSet
% For a nicer formatting, use the Matlab doc command
% For example, you might try
%   doc sceneGet
%   doc sceneSet

%% Explore the relationship between parameters
% To see an example of the dependence, consider the effect of scene
% distance, which we can get, on scene sample spacing.
dist    = sceneGet(scene,'distance','mm');
spacing = sceneGet(scene,'sample spacing','mm');
dist

%
% If we move the scene closer, and we maintain the same number of row and
% column samples, the spacing changes.
scene = sceneSet(scene,'distance',0.6);
sceneGet(scene,'sample spacing','mm');

%% You can change the distance and horizontal field of view (hFOV)
% This will change the sample spacing as well.
scene = sceneSet(scene,'hfov',hFOV/2);
sceneGet(scene,'sample spacing','mm')

%% Specifying units
% In this example, we specified the units of the sample spacing as
% millimemters (mm). We could have specified microns.
sceneGet(scene,'sample spacing','um')

% Or we could have specified the return in meters.
sceneGet(scene,'sample spacing','m')

%% Creating a scene from a file
% ISETBIO includes a few multispectral scenes.  These are large files, so the
% default distribution only includes one example.  We have another 100 or
% so that are available.
fname = fullfile(isetRootPath,'data','images','multispectral','stuffedAnimals_tungsten-hdrs.mat');
scene = sceneFromFile(fname,'multispectral');
vcAddAndSelectObject(scene); sceneWindow;

%% Plotting
% Many scene properties that can be plotted either from the scene Window or
% using plotScene. For example, ISETBIO scenes specify a uniform illuminant by
% default.  You can plot the illuminant in energy units by this command.
plotScene(scene,'illuminant energy roi');

% The plotScene command above is equivalent to
%  wave = sceneGet(scene,'wave');
%  illuminant  = sceneGet(scene,'illuminant energy');
%  vcNewGraphWin; plot(wave,illuminant); grid on
%  xlabel('wave (nm)'); ylabel('Energy (watts/sr/nm/m^2)')


%% You can change the illumination's spectral power distribution
% In this case, we create a blackbody illuminant and reilluminate the
% scene.
bb = blackbody(sceneGet(scene,'wave'),6500,'energy');
scene = sceneAdjustIlluminant(scene,bb);
vcReplaceAndSelectObject(scene); sceneWindow;

%% ISETBIO keeps track of units
% In this case, we plot the illuminant in units of photons, rather than
% energy.
plotScene(scene,'illuminant photons roi');



##### SOURCE END #####
--></body></html>