
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>t_ExposureValue</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-02-22"><meta name="DC.source" content="t_sensorExposureValue.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>t_ExposureValue</h1><!--introduction--><p>Tutorial on setting the camera exposure value and bracketing</p><p>Setting the exposure value is an extremely important control decision for the camera controller:  image quality depends strongly on this algorithm. One of the great values of high-dynamic range sensors is that they are robust to exposure value algorithm errors.</p><p>The term 'exposure value' refers to the joint setting of exposure time and the size of the aperture (f/#).  Longer times and larger apertures increase the number of photons incident at the sensor surface.  The formula for exposure value and the computation are described in the ISET function exposureValue.m.  This function is not part of ISETBIO, but since this tutorial runs under ISETBIO and it is fun.  we kept it around.</p><p>The goal of the exposure value algorithm is to put enough photons into the sensor pixels so that the pixels are operating in a high signal-to-noise range and are not saturated.  When there is a high dynamic range image, it may be impossible for this condition to be satisfied for the entire image, so compromises may be made.</p><p>Since exposure value algorithms must operate quickly, and since some parts of the image are more important than others, it is common to sample only regions near the center of the image.</p><p>This script illustrates the effect of different exposure times and f/# choices on sample images.</p><p>Copyright ImagEval Consultants, LLC, 2010.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Initialize ISET, if you like</a></li><li><a href="#2">Choose an HDR scene</a></li><li><a href="#3">Create the optical image</a></li><li><a href="#4">Create a sensor and capture the image</a></li><li><a href="#5">END</a></li></ul></div><h2>Initialize ISET, if you like<a name="1"></a></h2><pre class="codeinput">s_initISET;
</pre><h2>Choose an HDR scene<a name="2"></a></h2><pre class="codeinput">fName = fullfile(isetRootPath,<span class="string">'data'</span>,<span class="string">'images'</span>,<span class="string">'multispectral'</span>,<span class="string">'Feng_Office-hdrs.mat'</span>);
scene = sceneFromFile(fName,<span class="string">'multispectral'</span>);

<span class="comment">% Set the field of view to 15 deg</span>
fov   = 15;
scene = sceneSet(scene,<span class="string">'fov'</span>,fov);
</pre><pre class="codeoutput">Reading multispectral data with mcCOEF.
Saved using svd method
</pre><h2>Create the optical image<a name="3"></a></h2><pre class="codeinput">oi = oiCreate;
oi = oiCompute(scene,oi);

<span class="comment">% Notice that this is a very high dynamic range scene.  The window is very</span>
<span class="comment">% bright and the region under the desk is very dark.  Set the display Gamma</span>
<span class="comment">% value (text at the lower left) to 0.3 to be able to see all the parts of</span>
<span class="comment">% the image.</span>
vcAddAndSelectObject(oi); oiWindow;
</pre><img vspace="5" hspace="5" src="t_sensorExposureValue_01.png" alt=""> <h2>Create a sensor and capture the image<a name="4"></a></h2><p>Here is a VGA sensor</p><pre class="codeinput">sensor = sensorCreate;
sensor = sensorSetSizeToFOV(sensor,fov,scene,oi);

<span class="comment">% Let's use the exposure bracketing feature of ISET sensorCompute to</span>
<span class="comment">% calculate a series of images at different exposure durations. We can</span>
<span class="comment">% do this with the bracketing method in sensorCompute.</span>
expTimes = [0.005 0.010 0.050 0.100 0.2];
sensor   = sensorSet(sensor,<span class="string">'Exposure Time'</span>,expTimes);
sensor   = sensorCompute(sensor,oi);
sensor   = sensorSet(sensor,<span class="string">'ExposurePlane'</span>,3);

<span class="comment">% Look through the exposure durations in the window, using the gui.</span>
<span class="comment">% The relevant slider is towards the lower left of the gui window.</span>
vcAddAndSelectObject(sensor); sensorImageWindow;
</pre><img vspace="5" hspace="5" src="t_sensorExposureValue_02.png" alt=""> <h2>END<a name="5"></a></h2><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% t_ExposureValue
%
% Tutorial on setting the camera exposure value and bracketing
%
% Setting the exposure value is an extremely important control decision for
% the camera controller:  image quality depends strongly on this algorithm.
% One of the great values of high-dynamic range sensors is that they are
% robust to exposure value algorithm errors.
%
% The term 'exposure value' refers to the joint setting of exposure time
% and the size of the aperture (f/#).  Longer times and larger apertures
% increase the number of photons incident at the sensor surface.  The
% formula for exposure value and the computation are described in the ISET
% function exposureValue.m.  This function is not part of ISETBIO, but
% since this tutorial runs under ISETBIO and it is fun.  we kept it around.
%
% The goal of the exposure value algorithm is to put enough photons into
% the sensor pixels so that the pixels are operating in a high
% signal-to-noise range and are not saturated.  When there is a high
% dynamic range image, it may be impossible for this condition to be
% satisfied for the entire image, so compromises may be made.
%
% Since exposure value algorithms must operate quickly, and since some
% parts of the image are more important than others, it is common to sample
% only regions near the center of the image.
%
% This script illustrates the effect of different exposure times and f/#
% choices on sample images.
%
% Copyright ImagEval Consultants, LLC, 2010.

%% Initialize ISET, if you like
s_initISET;

%% Choose an HDR scene
fName = fullfile(isetRootPath,'data','images','multispectral','Feng_Office-hdrs.mat');
scene = sceneFromFile(fName,'multispectral');

% Set the field of view to 15 deg
fov   = 15; 
scene = sceneSet(scene,'fov',fov);

%% Create the optical image
oi = oiCreate;
oi = oiCompute(scene,oi);

% Notice that this is a very high dynamic range scene.  The window is very
% bright and the region under the desk is very dark.  Set the display Gamma
% value (text at the lower left) to 0.3 to be able to see all the parts of
% the image.
vcAddAndSelectObject(oi); oiWindow;

%% Create a sensor and capture the image
%
% Here is a VGA sensor
sensor = sensorCreate;
sensor = sensorSetSizeToFOV(sensor,fov,scene,oi);

% Let's use the exposure bracketing feature of ISET sensorCompute to
% calculate a series of images at different exposure durations. We can 
% do this with the bracketing method in sensorCompute.
expTimes = [0.005 0.010 0.050 0.100 0.2];
sensor   = sensorSet(sensor,'Exposure Time',expTimes);
sensor   = sensorCompute(sensor,oi);
sensor   = sensorSet(sensor,'ExposurePlane',3);

% Look through the exposure durations in the window, using the gui.
% The relevant slider is towards the lower left of the gui window.
vcAddAndSelectObject(sensor); sensorImageWindow;

%% END


##### SOURCE END #####
--></body></html>