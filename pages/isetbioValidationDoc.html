<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>ISETBIO VALIDATION</title>
        
        <!-- URL for styles
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap-theme.min.css">
        -->
        <link rel="stylesheet" href="../stylesheets/bootstrap/3.0.3/css/bootstrap.min.css">
        <link rel="stylesheet" href="../stylesheets/bootstrap/3.0.3/css/bootstrap-theme.min.css">


        <!-- STYLE SPECIFIC TO THIS PAGE -->
        <link rel="stylesheet" href="isetbioValidationStyle.css">

        <!-- javascripts for navbar -->
        <script type="text/javascript" src="../javascripts/jquery/1.11.1/jquery.min.js"></script>
        <script type="text/javascript" src="../javascripts/bootstrap/3.0.3/js/bootstrap.min.js"></script>
        
        <!-- add javascript for smooth scrolling   -->
        <script type="text/javascript" src="../javascripts/smoothscroll.js"></script>

        <!-- javascript script for collapsing the navbar on click  -->
        <script>
            $(document).on('click',function(){
                $('.navbar-collapse').collapse('hide');
            })
        </script>
    </head>
    
    <body> 
        <!-- NAVIGATION BAR ON TOP -->
        <div class="navbar-wrapper">
        <div class="container">
        <nav id="navigationBar" role="navigation" class="nav-collapse navbar-fixed-top navbar-inverse">
            <div class="container-fluid">
                    
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" data-target="#navbarCollapse" data-toggle="collapse" class="navbar-toggle">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="bright-logo-text navbar-brand" href="http://isetbio.org"><b>isetbio.org</b></a>
                </div>
                
                <!-- Collection of nav links and other content for toggling -->
                <div id="navbarCollapse" class="navbar-collapse collapse" style="width:100%;float:none;position:relative;">
                    <ul class="nav navbar-nav" role="navigation" style="width:auto;white-space: nowrap;">
        
                        <!-- First menu item -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                @UnitTest-based validation <b class="caret"></b>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="#overview" class="smoothScroll"> overview </a></li>
                                <li><a href="#data validation" class="smoothScroll"> data validation</a></li>
                                <li><a href="#data validation:external checks" class="smoothScroll"> data validation: external checks </a></li>
                                <li><a href="#data validation:internal checks" class="smoothScroll"> data validation: internal checks</a></li>
                            </ul>
                        </li>
                        
                        <!-- Second menu item -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                Conducting validation sessions <b class="caret"></b>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="#basic validation sessions" class="smoothScroll"> basic validation</a></li>
                                <li><a href="#customizing validation sessions" class="smoothScroll"> customizing the validation</a></li>
                            </ul>
                        </li>
                        
                        <!-- Third menu item -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                Writing validation scripts <b class="caret"></b>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="#the wrapper function" class="smoothScroll">the wrapper function</a></li>
                                <li><a href="#the validation function" class="smoothScroll">the validation function</a></li>
                            </ul>
                        </li>
                        
                        <!-- Fourth menu item -->
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                Miscellaneous information<b class="caret"></b>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="#feedback emitted under different verbosity levels" class="smoothScroll">feedback emitted under different verbosity levels</a></li>
                            </ul>
                        </li>
                        
                        
                    </ul>
                </div>
            </div>
        </nav>
        </div>
        </div>
        
        <!-- Use .container-fluid for a full width container, spanning the entire width of the viewport -->
        <div class="container-fluid">
            
        <div class="jumbotron">
                <h1>isetbio:validation</h1>      
        </div>
        
            
        <p>
            Welcome to the isetbio:validation page.
        </p>     
        
        
        <h7> 
            <a id="overview" href="#overview"></a> <hr>
        </h7>
        <h3>
           @UnitTest-based validation
        </h3>
            
        
            
        <!-- OVERVIEW -->
        <h7> 
            <a id="overview" href="#overview"></a> <hr>
        </h7>
        <h4>
           overview
        </h4>
        
        <p>
             This document describes the capabilities and usage of the @UnitTest class for managing isetbio validation scripts. The class executes isetbio scripts, checks for runtime errors, manages the data and reports generated by these scripts, validates data against a ground truth dataset, produces published reports of the isetbio code and the resulting output, and pushes these reports to isetbio's github site for use as isetbio tutorials. Different functionalities can be enabled via user-adjustable preferences.
        </p>
        
        <p>
            In the @UnitTest validation framework, an executive script is used to define a <strong> validation session</strong> and to instantiate a @UnitTest object that will manage the session. A validation session is specified by: 
           <ul>
               <li> a list of validation scripts, </li>
               <li> a validation mode and, </li>
               <li> a set of optional validation preferences, for customizing the validation.</li>
           </ul>
        </p>
    
        <p>
           The following validation modes are available:
        </p>
        
        <p>
        <ul>
            <li><magenta> 'RUNTIME_ERRORS_ONLY'</magenta>, checking only for run-time exceptions during script execution,</li>
            <li><magenta> 'FAST' </magenta>, checking for run-time exceptions + SHA-256 signature validation of select data,</li>
            <li><magenta>'FULL' </magenta>, checking for run-time exceptions + numerical validation of select data,</li>
            <li><magenta>'PUBLISH'</magenta>, checking for run-time exceptions + numerical validation + publication to <a href="https://github.com/isetbio/isetbio/wiki/ValidationResults">github site.</a></li>
        </ul>
        </p>

        <p> 
            The <magenta>'RUNTIME_ERRORS_ONLY'</magenta> mode is the quickest and may be useful to check the basic integrity of isetbio core methods, for example that calls to them do not crash. 
        </p>

        <p> 
            The <magenta> 'FAST'</magenta> validation mode can be used to check that data generated by isetbio scripts agree across different versions of isetbio and/or across different machines/operating systems.
        </p>

        <p>
            If any data inconsistencies are detected during a <magenta>'FAST'</magenta> validation, the <magenta>'FULL'</magenta> validation mode is useful to identify the data fields whose values differ from ground truth and to provide quantitative descriptions of the differences. 
        </p>

        <p> 
            Finally, the <magenta>'PUBLISH'</magenta> validation mode is useful for generating published reports of isetbio code with plots of generated data. These reports are pushed to <a href="https://github.com/isetbio/isetbio/wiki/ValidationResults">isetbio's github site</a> and can serve as tutorials for the various functionalities of isetbio.
        </p>
        
        <h7> 
            <a id="data validation" href="#data validation"></a> <hr>
        </h7>
        <h4>
           data validation
        </h4>
        
        <p>
        For all validation modes other than <magenta>'RUNTIME_ERRORS_ONLY'</magenta>, the @UnitTest object enables two methods of data validation: <b>external</b> checks, in which data logged by validation scripts are contrasted to corresponding data in a ground truth dataset, and <b>internal</b> checks, in which validation scripts report their own validation status based on assessments conducted within the scripts themselves.  
        </p>

        <!--
            Data validation: external checks
        -->
        <h7> 
            <a id="data validation:external checks" href="#data validation:external checks"></a> <hr>
        </h7>
        <h4>
           external checks
        </h4>
        
      	 <p>
            The @UnitTest class provides methods that enable validation scripts to log select data for inclusion to their validation dataset. The first time that a validation script is executed by a @UnitTest object, the generated validation dataset becomes the <strong>ground truth </strong> for this script. In subsequent runs, the managing @UnitTest object compares the generated dataset to the data in the corresponding ground truth to establish whether the current script produces data consistent with the script's ground truth. 
        </p>
        
        <p>
            The type of comparison between validation and ground truth data sets is determined by the selected <magenta> validation mode</magenta>.
        </p>
        
        <p class="tab">
        In <magenta> 'FAST'</magenta> validations, all numerical fields of the validation dataset are truncated to 12 decimal digits, and a SHA-256 hash key is generated based on the truncated data set. A validation script passes <magenta> 'FAST'</magenta> validation, if the hash key matches exactly the hash key stored in the ground truth dataset. We have found that data truncation to 12 decimal digits generate hash keys that match across different Mac computers (three dekstops and one laptop, all running OSX), whereas truncation to 13 or more decimal digits generate hash keys that do not match across these computers. We do not know the situation about Windows/Linux computers yet.
        </p>
        
        <p class="tab">
            In <magenta> 'FULL'</magenta> and <magenta> 'PUBLISH'</magenta> validations, corresponding fields of the validation and ground truth data sets are compared. A validation script passes these validation modes, if the absolute differences between corresponding fields in the two datasets do not exceed a numerical threshold, which is determined by a user-adjustable @UnitTest preference.
        </p>
        
        <!--
            Data validation: internal checks
        -->
        <h7> 
            <a id="data validation:internal checks" href="#data validation:internal checks"></a> <hr>
        </h7>
        <h4>
          internal checks
    	</h4>
        
        <p>
        The @UnitTest class also provides methods that allow a script to report whether it has pass any internal validation checks, based on assessments conducted within the validation script itself. For example, a validation script may check the agreement between results generated by isetbio computations and results generated by other means, for example psychtoolbox computations. If the agreement is not satisfactory, the validation script can log to the managing @UnitTest object that it has failed to pass a particular internal check. 
        </p>
        <p> The @UnitTest class provides a mechanism by which scripts can log the results of any number of internal checks. If any of these checks fails, the @UnitTest object declares that the script has failed to pass validation. A detailed report of which internal checks failed and which passed is sent to the command window depending on the verbosity level preference.
        </p>
        
        
        <h7> 
            <a id="basic validation sessions" href="#basic validation sessions"></a> <hr>
        </h7>
        <h3>
           Conducting validation sessions
        </h3>
        
        <h7> 
            <a id="basic validation sessions" href="#basic validation sessions"></a> <hr>
        </h7>
        <h4>
           basic validation
        </h4>
        

        <p>
             A basic validation is triggerred by calling the following @UnitTest class method: 
            <p class="tab">
                <blackCode>UnitTest.runValidationSession(<blueCode>vScriptsList</blueCode>, <magenta>validationMode</magenta>);</blackCode>
            </p>
            where <blueCode>vScriptsList</blueCode> is a cell array containing the names of individual validation scripts or the names of directories containing validation scripts, and <magenta>validationMode</magenta> is one of the four validation modes discussed earlier. If no <magenta>validationMode</magenta> variable is passed, the user will be asked to provide one. 
        </p>

        <p>
            Examples of basic validation modes are shown below. The first example validates two scripts, first using a <magenta>FAST</magenta> validation mode, then using a <magenta>FULL</magenta> validation mode. This situation would be encountered when new validation scripts are introduced and we want to generate FAST and FULL ground truth data sets for them.
        </p>    
<pre><greenCode>% Basic validation of scripts v_Colorimetry.m and v_IrradianceIsomerizations.m 
</greenCode><blackCode>
<blueCode>vScriptsList</blueCode> = {...
  {'v_Colorimetry'} ...
  {'v_IrradianceIsomerizations'} ...
};

UnitTest.runValidationSession(<blueCode>vScriptsList</blueCode>, <magenta>'FAST'</magenta>);
UnitTest.runValidationSession(<blueCode>vScriptsList</blueCode>, <magenta>'FULL'</magenta>);</blackCode>
</pre>

        <p> The example below does a <magenta>RUN_TIME_ERRORS_ONLY</magenta> validation of all scripts located in a number of directories. This situation would be encountered when some basic core functionality in isetbio is changed and we want to quickly assert whether this change breaks fundamental isetbio operations.
        </p> 
<pre><blackCode><greenCode>% Basic 'RUN_TIME_ERRORS_ONLY' mode validation session of all scripts in the following 
directories:
% validationScripts/scene 
% validationScripts/opticalImage
% validationScripts/sensor
% validationScripts/radiometry
</greenCode>
<blueCode>vScriptsList</blueCode> = {...
  {'validationScripts/scene'} ...
  {'validationScripts/opticalImage'} ...
  {'validationScripts/sensor'} ...
  {'validationScripts/radiometry'} ...
};

UnitTest.runValidationSession(<blueCode>vScriptsList</blueCode>, <magenta>'RUN_TIME_ERRORS_ONLY'</magenta>);</blackCode>
</pre>


        <h7> 
            <a id="customizing validation sessions" href="#customizing validation sessions"></a> <hr>
        </h7>
        <h4>
           customizing the validation
        </h4>

        <p>
            The @UnitTest class provides several preferences that the user can adjust in order to customize isetbio validations. The available preferences and their current values can be obtained by the following call:
            <p class="tab">
                <blackCode>UnitTest.listPrefs();</blackCode>
            </p>
            which, at the time that this document was last updated, produced the following output:
<pre>
Current isetbioValidation prefs:
<strong>'updateGroundTruth'</strong>      : <em>false</em>
<strong>'updateValidationHistory'</strong>: <em>false</em>
<strong>'onRunTimeErrorBehavior'</strong> : <em>'rethrowExceptionAndAbort'</em>
<strong>'generatePlots'</strong>          : <em>false</em>
<strong>'closeFigsOnInit'</strong>        : <em>true</em>
<strong>'verbosity'</strong>              : <em>'low'</em>
<strong>'numericTolerance'</strong>       : <em>1.11022e-13</em>
<strong>'graphMismatchedData'</strong>    : <em>true</em>
<strong>'validationRootDir'</strong>      : <em>'/Users/Shared/Matlab/Toolboxes/ISETBIO/validation'</em>
<strong>'clonedWikiLocation'</strong>     : <em>'/Users/Shared/Matlab/Toolboxes/ISETBIO_Wiki/isetbio.wiki'</em>
<strong>'clonedGhPagesLocation'</strong>  : <em>'/Users/Shared/Matlab/Toolboxes/ISETBIO_GhPages/isetbio'</em>
<strong>'githubRepoURL'</strong>          : <em>'http://isetbio.github.io/isetbio'</em>
</pre>
        </p>
        
        <p>
            The allowable values and functionality of each of these preferences are summarized below.
            <table class="TFtable">
                <tr>
                    <td>
                        <blackCode><strong>'updateGroundTruth'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> true/false </lightBlueCode>
                    </td>
                    <td>
                        if set to true, the @UnitTest object will append the current validation data to the history of ground truth data sets.
                    </td>
                </tr>
	
                <tr>
                    <td>
                        <blackCode><strong>'updateValidationHistory'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> true/false </lightBlueCode>
                    </td>
                    <td>
                        if set to true, the @UnitTest object will append the current validation data to the history of validation  data sets.
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'onRunTimeErrorBehavior'</strong> </blackCode>
                        <br> 
                        <lightBlueCode>
                        'catchExceptionAndContinue' 'rethrowExceptionAndAbort'
                        </lightBlueCode>
                    </td>
                    <td>
                        if set to <lightBlueCode>'catchExceptionAndContinue'</lightBlueCode>, and a validation script raises an exception at run time, the @UnitTest object will allow the validation session to continue evaluating the remaining scripts. If set to <lightBlueCode>
'rethrowExceptionAndAbort'</lightBlueCode>, the validation session will be terminated.
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'generatePlots'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> true/false </lightBlueCode>
                    </td>
                    <td>
                        if set to true, validation scripts are allowed to generate plots. For 'FAST' or 'RUN_TIME_ERRORS_ONLY' validation runs this would usually set to false. It is up to the validation script author to abide by this preference and generate plots accordingly.
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'closeFigsOnInit'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> true/false </lightBlueCode>
                    </td>
                    <td>
                        if set to true, the @UnitTest object will close any existing figures generated by previous scripts during the initialization phase of the current script.
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'verbosity'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> 'none', 'min', 'low', 'med', 'high', 'max' </lightBlueCode>
                    </td>
                    <td>
                        determines how much feedback information is emitted to the command window by the @UnitTest object. 
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'numericTolerance'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> multiple of EPS (usually 500*EPS) </lightBlueCode>
                    </td>
                    <td>
                        determines the minimal difference in numerical value between validation and ground truth data in order for the @UnitTest object to trigger a validation FAILED flag.  
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'graphMismatchedData'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> true/false </lightBlueCode>
                    </td>
                    <td>
                        if set to true, and the value of a validation field differs from its corresponding ground truth value by more than the value of 'numericTolerance', the @UnitTest object will generate plots of the validation data, the ground truth data, and their difference. Applies only to 'FULL' and 'PUBLISH' validation modes.
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'validationRootDir'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> path string  </lightBlueCode>
                    </td>
                    <td>
                        absolute path of the folder under which validation script directories live. Must be set according to the user's local machine configuration.
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'clonedWikiLocation'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> path string </lightBlueCode>
                    </td>
                    <td>
                        absolute path of the folder under which the isetbio.wiki is cloned. Must be set according to the user's local machine configuration. Applies only to 'PUBLISH' validation mode.
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'clonedGhPagesLocation'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> path string </lightBlueCode>
                    </td>
                    <td>
                        absolute path of the folder under which the 'gh-pages' branch of isetbio is cloned. Must be set according to the user's local machine configuration. Applies only to 'PUBLISH' validation mode.
                    </td>
                </tr>
                
                <tr>
                    <td>
                        <blackCode><strong>'githubRepoURL'</strong> </blackCode>
                        <br> 
                        <lightBlueCode> github URL of isetbio </lightBlueCode>
                    </td>
                    <td>
                       currently: 'http://isetbio.github.io/isetbio'
                    </td>
                </tr>
            </table>
        </p>
        
        <p>
            The user can change any of these preferences by the following call:
            <p class="tab">
                <blackCode>UnitTest.setPref(preferenceName, preferenceValue);</blackCode>
            </p>
            thus, customizing a validation session for different purposes. The following code shows an example of customizing a 'FULL' validation session.
        </p> 

<pre><greenCode>% Executive script for customized validation</greenCode>
function validateDemo

<greenCode> % Initialize @UnitTest preferences</greenCode>
 UnitTest.initializePrefs();
    
<greenCode> % Optionally, reset prefs to the default values </greenCode>
 UnitTest.initializePrefs('reset');
    
<greenCode> % Change some preferences:</greenCode>
<greenCode> % Update the histories of validation data sets</greenCode>
 UnitTest.setPref('updateValidationHistory', true);
 UnitTest.setPref('updateGroundTruth', false);

<greenCode> % Run time error behavior </greenCode>
 UnitTest.setPref('onRunTimeErrorBehavior', 'rethrowExceptionAndAbort');

<greenCode> % Plot generation </greenCode>
 UnitTest.setPref('generatePlots',  true); 
 UnitTest.setPref('closeFigsOnInit', true);

<greenCode> % Send medium amount of feedback info to the command window </greenCode>
 UnitTest.setPref('verbosity', 'med');

<greenCode> % Numeric tolerance for comparison to ground truth data </greenCode>
 UnitTest.setPref('numericTolerance', 500*eps);
    
<greenCode> % Whether to plot data that do not agree with the ground truth </greenCode>
 UnitTest.setPref('graphMismatchedData', false);

<greenCode> % Print current values of isetbioValidation prefs</greenCode>
 UnitTest.listPrefs();

<greenCode>% What to validate </greenCode>
 <blueCode>vScriptsList</blueCode> = {...
  {'validationScripts/scene'} ...
  {'validationScripts/opticalImage'} ...
  {'validationScripts/sensor'} ...
  {'validationScripts/radiometry'} ...
};

<greenCode> % Go !  </greenCode>
 UnitTest.runValidationSession(<blueCode>vScriptsList</blueCode>, <magenta>'FULL'</magenta>);

end
</pre>
        
<!--
		WRITING VALIDATION SCRIPTS
-->        
        
        <h7> 
            <a id="writing validation scripts" href="#writing validation scripts"></a> <hr>
        </h7>
        <h3>
           Writing validation scripts
        </h3>

        <p>
            This section describes how to craft validation scripts so that can be managed by @UnitTest objects. All @UnitTest-manageable scripts must contain a <b>wrapper function</b> followed by the <b>validation function</b>, which contains the actual isetbio validation code. 
        </p>
        <h7> 
            <a id="the wrapper function" href="#the wrapper function"></a> <hr>
        </h7>
        <h4>
           the wrapper function        
        </h4>
        <p>
        <p>
			The main purpose of the wrapper function is to call the validation function and to communicate information between the validation function and the managing @UnitTest object. This function also ensures that the script can be run in stand-alone mode, i.e., without being called by the managing @UnitTest object. 
        </p>    
        <p>
            The wrapper function is named according to the isetbio functionality that is tested (irradiance isomerization computations, in the following example). The body of the wrapper function must contain a docstring in line #2 which is used to describe this purpose of this validation script in isetbio's validation <a href="https://github.com/isetbio/isetbio/wiki/ValidationResults">github site</a>. The remaining of this function is identical across all validation scripts. 
		 </p>
		<p> The wrapper function for script <blackCode>v_IrradianceIsomerizations.m</blackCode> is shown below.
		 </p>

<pre>
<blackCode>function varargout = v_IrradianceIsomerizations(varargin)
<grayCode><greenCode>%
% Validate ISETBIO-based irradiance/isomerization computations by comparing to PTB-based
% irradiance/isomerization computations.
%</greenCode>

<greenCode>% Initialize validation run and return params</greenCode>
 runTimeParams = UnitTest.initializeValidationRun(varargin{:});
 if (nargout > 0) varargout = {'', false, []}; end
    
<greenCode>% Validation - Call validation script</greenCode>
<blueCode> ValidationFunction(runTimeParams); </blueCode>
    
<greenCode>%  Reporting and return params</greenCode>
 if (nargout > 0)
    [validationReport, ...
     validationFailedFlag, ...
     validationFundametalFailureFlag] = ...
                      UnitTest.validationRecord('command', 'return');
    validationData  = UnitTest.validationData('command', 'return');
    extraData       = UnitTest.extraData('command', 'return');
    varargout       = {validationReport, validationFailedFlag, ...
                       validationFundametalFailureFlag, validationData, ...
                       extraData};
 else
    if (runTimeParams.printValidationReport)
        [validationReport, ~] = UnitTest.validationRecord('command', 'return');
        UnitTest.printValidationReport(validationReport);
    end 
 end
</grayCode>end    
</blackCode>
</pre>
		 <h7> 
            <a id="the validation function" href="#the validation function"></a> <hr>
        </h7>
        <h4>
           the validation function        
        </h4>
     	
		<p>
       The validation function contains the isetbio code to be tested. Interspersed amongst the evaluation code are calls to @UnitTest methods for logging <b>data</b> and <b>messages</b> to the managing @UnitTest object. 
       </p>
       <p>
       Two types of <b>data</b> can be logged: 
       	<ul>
        		<li> <strong> validation data</strong>, which are the data used during external validations </li>
              <li> <strong> extra data</strong>, which are additional data, not used during the validation, but nevertheless stored in the saved ground truth history as reference data</li>
               
           </ul>
      	</p>
		Data logging is achieved by the following calls:
		<p class="tab">
         	<blackCode>UnitTest.validationData(fieldName, fieldValue);</blackCode><br>
         	<blackCode>UnitTest.extraData(fieldName, fieldValue);</blackCode>
      	</p>
      	<p>
       At validation time, the managing @UnitTest object warns the user if a validation script tries to log data under a previously used field name.
       </p>
		<p>
       The following types of <b>messages</b> can be logged: 
       	<ul>
        		<li> <b>simple messages</b> with no special status, </li>
              <li> messages indicating that a <b>fundamental internal check failed</b></li>
              <li> messages indicating that an <b>internal check failed</b></li>
				<li> messages indicating that an <b>internal check passed</b></li>
          </ul>
      	</p>
      	Message logging is achieved by the following calls:
		<p class="tab">
		   <blackCode>UnitTest.validationRecord(<magenta>'SIMPLE_MESSAGE'</magenta>, messageString);</blackCode><br>
		   <blackCode>UnitTest.validationRecord(<magenta>'FUNDAMENTAL_CHECK_FAILED'</magenta>, messageString);</blackCode><br>
         	<blackCode>UnitTest.validationRecord(<magenta>'FAILED'</magenta>, messageString);</blackCode><br>
         	<blackCode>UnitTest.validationRecord(<magenta>'PASSED'</magenta>, messageString);</blackCode><br>
      	</p>
      	
		<p>
		A portion of the validation function for script <blackCode>v_IrradianceIsomerizations.m</blackCode> is shown below. The interpersed @UnitTest calls for logging data and messages are outlined in black.
<pre>
function ValidationFunction(<blueCode>runTimeParams</blueCode>)
<grayCode><greenCode>%% Initialize ISETBIO</greenCode>
s_initISET;
       
<greenCode>% Log a section message. This can be useful for organizing the validation report.</greenCode>
<blackCode>UnitTest.validationRecord(<magenta>'SIMPLE_MESSAGE'</magenta>, '*** Report section 1 ***');</blackCode>

<greenCode>%% Set computation params</greenCode>
fov     = 20;  % need large field
roiSize = 5;
    
<greenCode>%% Compute the irradiance in ISETBIO</greenCode>
oi     = oiCreate('human');
optics = oiGet(oi,'optics');
optics = opticsSet(optics,'off axis method','skip');
optics = opticsSet(optics,'otf method','skip otf');
oi     = oiSet(oi,'optics',optics);
oi     = oiCompute(oi,scene);

<greenCode>%% Define a region of interest starting at the scene's center with size roiSize x roiSize</greenCode>
sz = sceneGet(scene,'size');
rect = [sz(2)/2,sz(1)/2,roiSize,roiSize];
sceneRoiLocs = ieRoi2Locs(rect);
    
<greenCode>%% Get wavelength and spectral radiance spd data (averaged within the scene ROI)</greenCode> 
wave  = sceneGet(scene,'wave');
radiancePhotons = sceneGet(scene,'roi mean photons', sceneRoiLocs);
radianceEnergy  = sceneGet(scene,'roi mean energy',  sceneRoiLocs); 
    
<greenCode>%% Check spatial uniformity of scene radiance data.
% This also verifies that two ways of getting the same information out in isetbio give the same answer.</greenCode>
radianceData = vcGetROIData(scene,sceneRoiLocs,'energy');
radianceEnergyCheck = mean(radianceData,1);
if (any(radianceEnergy ~= radianceEnergyCheck))
   message='Two ways of extracting mean scene radiance in isetbio do not agree.';
   <blackCode>UnitTest.validationRecord(<magenta>'FUNDAMENTAL_CHECK_FAILED'</magenta>, message);</blackCode>
   return;
end

radianceUniformityErr = (max(radianceData(:))-min(radianceData(:)))/mean(radianceData(:));
uniformityRadianceTolerance = 0.00001;
if (radianceUniformityErr > uniformityRadianceTolerance)
   message = sprintf('Spatial uniformity of scene radiance is worse than %0.3f%% !!!', 100*uniformityRadianceTolerance);
   <blackCode>UnitTest.validationRecord(<magenta>'FAILED'</magenta>, message);</blackCode>
else
   message = sprintf('Spatial uniformity of scene radiance is good to at least %0.3f%%',100*uniformityRadianceTolerance);
   <blackCode>UnitTest.validationRecord(<magenta>'PASSED'</magenta>, message);</blackCode>
end

<greenCode>%% Get wavelength and spectral irradiance spd data (averaged within the scene ROI).
% Need to recenter roi when computing from the optical image, because the optical image is padded to deal with optical blurring at its edge.</greenCode>
sz         = oiGet(oi,'size');
rect       = [sz(2)/2,sz(1)/2,roiSize,roiSize];
oiRoiLocs  = ieRoi2Locs(rect);
if (any(wave-oiGet(scene,'wave')))
   <blackCode>UnitTest.validationRecord(<magenta>'FUNDAMENTAL_CHECK_FAILED'</magenta>, 'Wavelength sampling changed between scene and optical image.');</blackCode>
   return;
end

isetbioIrradianceEnergy = oiGet(oi,'roi mean energy', oiRoiLocs);

<greenCode>%% Check spatial uniformity of optical image irradiance data.
% With optics turned off, we think this should be perfect but it isn't.
% It's good to 1%, but not to 0.1%.  This may be why PTB and isetbio only agree to about 1%
% This also verifies that two ways of getting the same information out in isetbio give the same answer.</greenCode>
irradianceData = vcGetROIData(oi,oiRoiLocs,'energy');
irradianceEnergyCheck = mean(irradianceData,1);
if (any(isetbioIrradianceEnergy ~= irradianceEnergyCheck))
   message='Two ways of extracting mean optical image irradiance in isetbio do not agree.';
   <blackCode>UnitTest.validationRecord(<magenta>'FUNDAMENTAL_CHECK_FAILED'</magenta>, message);</blackCode>
   return;
end

irradianceUniformityErr = (max(irradianceData(:)) - min(irradianceData(:))) mean(irradianceData(:));
uniformityIrradianceTolerance = 0.01;
if (irradianceUniformityErr > uniformityIrradianceTolerance)
   message = sprintf('Spatial uniformity of optical image irradiance is worse than %0.1f%% !!!', 100*uniformityIrradianceTolerance);
   <blackCode>UnitTest.validationRecord(<magenta>'FAILED'</magenta>, message);</blackCode>
else
   message = sprintf('Spatial uniformity of optical image irradiance is good to %0.1f%%',100*uniformityIrradianceTolerance);
   <blackCode>UnitTest.validationRecord(<magenta>'PASSED'</magenta>, message);</blackCode>
end

<greenCode>% Log some extra data </greenCode>
<blackCode>UnitTest.extraData('irradianceData',irradianceData);</blackCode>
<blackCode>UnitTest.extraData('irradianceUniformityErr',irradianceUniformityErr);</blackCode>
    
<greenCode>%% Get the underlying parameters that are needed from the ISETBIO structures.</greenCode>
optics = oiGet(oi,'optics');
pupilDiameterMm  = opticsGet(optics,'pupil diameter','mm');
focalLengthMm    = opticsGet(optics,'focal length','mm');
    
<greenCode>%% Compute the irradiance in PTB
% The PTB calculation is encapsulated in ptb.ConeIsomerizationsFromRadiance.
% This routine also returns cone isomerizations, which we will use below to
% to validate that computation as well.
%
% The macular pigment and integration time parameters affect the isomerizations,
% but don't affect the irradiance returned by the PTB routine.
% The integration time doesn't affect the irradiance, but we need to pass it </greenCode>
macularPigmentOffset = 0;
integrationTimeSec   = 0.05;
[ptbIsomerizations, ~, ptbPhotoreceptors, ptbIrradiance] = ...
    ptb.ConeIsomerizationsFromRadiance(radianceEnergy(:), wave(:),...
    pupilDiameterMm, focalLengthMm, integrationTimeSec,macularPigmentOffset);
    
<greenCode>%% Compare irradiances computed by ISETBIO vs. PTB
%
% The comparison accounts for a magnification difference in the
% computation of retinal irradiance.  The magnification difference
% results from how Peter Catrysse implemented the radiance to
% irradiance calculation in isetbio versus the simple trig formula used
% in PTB. Correcting for this reduces the difference to about 1%
% 
% It might be useful here to explain how the correction factor is deterimend.
% One assumes that the squaring deals with linear dimension to area.
% Why the absolute value around the (m), however, is mysterious to DHB.</greenCode>
m = opticsGet(optics,'magnification',sceneGet(scene,'distance'));
ptbMagCorrectIrradiance = ptbIrradiance(:)/(1+abs(m))^2;

<greenCode>%% Numerical check to decide whether we passed.
% We are checking against a 1% error.  We also store the computed values for future comparison via our validation and check mechanism.</greenCode>
tolerance = 0.01;
ptbMagCorrectIrradiance = ptbMagCorrectIrradiance(:);
isetbioIrradianceEnergy = isetbioIrradianceEnergy(:);
difference = ptbMagCorrectIrradiance-isetbioIrradianceEnergy;
if (max(abs(difference./isetbioIrradianceEnergy)) > tolerance)
    message = sprintf('Difference between PTB and isetbio irradiance exceeds tolerance of %0.1f%% !!!', 100*tolerance);
    <blackCode>UnitTest.validationRecord(<magenta>'FAILED'</magenta>, message);</blackCode>
else
    message = sprintf('PTB and isetbio agree about irradiance to %0.1f%%',100*tolerance);
    <blackCode>UnitTest.validationRecord(<magenta>'PASSED'</magenta>, message);</blackCode>
end

<greenCode>% Log validation data</greenCode><blackCode>
UnitTest.extraData('fov', fov);
UnitTest.extraData('roiSize', roiSize);
UnitTest.extraData('tolerance', tolerance);
UnitTest.extraData('magCorrectionFactor',m);
UnitTest.extraData('ptbMagCorrectIrradiance', ptbMagCorrectIrradiance);
UnitTest.extraData('isetbioIrradianceEnergy',isetbioIrradianceEnergy);
</blackCode>
<greenCode>% Log extra data</greenCode><blackCode>
UnitTest.extraData('scene', scene);
UnitTest.extraData('oi', oi);
</blackCode>
<greenCode>%% Compare spectral sensitivities used by ISETBIO and PTB.
%
% The PTB routine above uses the CIE 2-deg standard, which is the 
% Stockman-Sharpe 2-degree fundamentals.  Apparently, so does ISETBIO.
% The agreement is good to about a percent.
% Get PTB cones spectral sensitivity, quantal units</greenCode>
coneTolerance = 0.01;
ptbCones = ptbPhotoreceptors.isomerizationAbsorptance';

<greenCode>% Create isetbio sensor object with human cones, and pull out quantal efficiencies. </greenCode>
sensor = sensorCreate('human');
sensor = sensorSet(sensor,'size',oiGet(oi,'size'));
sensor = sensorSet(sensor,'noise flag',0);
isetbioCones = sensorGet(sensor,'spectral qe');
isetbioCones = isetbioCones(:,2:4);

<greenCode>% Compare with PTB</greenCode>
coneDifference = ptbCones-isetbioCones;
coneMean = mean(isetbioCones(:));
if (max(abs(coneDifference/coneMean)) > coneTolerance)
  message = sprintf('Difference between PTB and isetbio cone quantal efficiencies exceeds %0.1f%%!!!',100*coneTolerance);
  <blackCode>UnitTest.validationRecord(<magenta>'FAILED'</magenta>, message);</blackCode>
else
  message = sprintf('PTB and isetbio agree about cone quantal efficiencies good to %0.1f%%',100*coneTolerance);
  <blackCode>UnitTest.validationRecord(<magenta>'PASSED'</magenta>, message);</blackCode>
end

<greenCode>% Log validation data</greenCode>
<blackCode>UnitTest.validationData('isetCones',isetbioCones);
UnitTest.validationData('ptbCones',ptbCones);

<greenCode>% Log extra data</greenCode>
UnitTest.extraData('coneTolerance',coneTolerance);</blackCode>
    
<greenCode>% Check the 'generatePlots' preference and if it set to true, generate plots</greenCode>
if (<blueCode>runTimeParams.generatePlots</blueCode>)
  h = figure(500); clf;
  plot(wave,ptbIrradiance,'ro','MarkerFaceColor',[1. 0.8 0.8],'MarkerSize', 10);
  hold on;
  plot(wave,isetbioIrradianceEnergy,'bo','MarkerFaceColor',[.8 .8 .0],'MarkerSize',10);
  hold off
  set(gca,'ylim',[0 1.2*max([max(ptbIrradiance(:)) max(isetbioIrradianceEnergy(:))])]);
  set(gca, 'FontName', 'Helvetica', 'FontSize', 14,  'FontWeight', 'bold');
  legend({'PTB','ISETBIO'}, 'Location','SouthEast','FontSize',12);
  xlabel('Wave (nm)', 'FontName', 'Helvetica', 'FontSize', 16); 
  ylabel('Irradiance (q/s/nm/m^2)', 'FontName', 'Helvetica', 'FontSize', 16)  
end
        
</grayCode>end
</pre>
		</p>
		
	
<!--
		MISCELLANEOUS INFO
-->  

        <h7> 
            <a id="miscellaneous" href="#miscellaneous"></a> <hr>
        </h7>
        <h3>
           Miscellaneous information
        </h3>
        
        <h7> 
            <a id="feedback emitted under different verbosity levels" href="#feedback emitted under different verbosity levels"></a> <hr>
        </h7>
        <h4>
           Feedback emitted under different verbosity levels
        </h4>
        
        
        This section shows examples of feecback information emitted by the @UnitTest object under different modes and verbosity levels.
        <h4><hr>
        (i) 'RUNTIME_ERRORS_ONLY' validation mode
        </h4>
        <p>
        This section shows examples of feecback information emitted by the @UnitTest object in 'RUNTIME_ERRORS_ONLY' validation mode during validation of a collection of scripts. The information emitted in this validation mode is the same for verbosity levels 'min', 'low', 'med', and 'high'.
        </p>
<pre>
<smallBlackCode>---------------------------------------------------------------------------------------------------
Running in 'RUNTIME_ERRORS_ONLY' mode with 'catchExceptionAndContinue' and verbosity level = 'min'.
---------------------------------------------------------------------------------------------------

[  1] <smallBlueCode>'v_Colorimetry.m'</smallBlueCode>
   Internal validation  : PASSED
   Run-time status      : no exception raised

[  2] <smallBlueCode>'v_Cones.m'</smallBlueCode>
   Internal validation  : PASSED
   Run-time status      : no exception raised

[  3] <smallBlueCode>'v_HumanRetinalIlluminance580nm.m'</smallBlueCode>
   Internal validation  : PASSED
   Run-time status      : no exception raised

[  4] <smallBlueCode>'v_OTFandPupilSize.m'</smallBlueCode>
   Internal validation  : PASSED
   Run-time status      : no exception raised

[  5] <smallBlueCode>'v_IrradianceIsomerizations.m'</smallBlueCode>
   Internal validation  : PASSED
   Run-time status      : no exception raised

[  6] <smallBlueCode>'v_sceneReIllumination.m'</smallBlueCode>
   Internal validation  : PASSED
   Run-time status      : no exception raised

[  7] <smallBlueCode>'v_fundamentalValidationFailure.m'</smallBlueCode>
   <smallRedCode>Internal validation  : FUNDAMENTAL FAILURE !!</smallRedCode>
   Run-time status      : no exception raised

[  8] <smallBlueCode>'v_numericalPrecision.m'</smallBlueCode>
   Internal validation  : PASSED
   Run-time status      : no exception raised

[  9] <smallBlueCode>'v_runTimeError.m'</smallBlueCode>
   <smallRedCode>Internal validation  : FAILED
   Run-time status      : exception raised</smallRedCode>

[ 10] <smallBlueCode>'v_skeleton.m'</smallBlueCode>
   Internal validation  : PASSED
   Run-time status      : no exception raised</smallBlackCode>
</pre>
        <h4><hr>
           (ii) 'FAST' and 'FULL' validation modes
        </h4>
        <p>
        This section shows examples of feecback information emitted by the @UnitTest object in 'FAST' and 'FULL' validation modes during validation of one script, <blackCode>'v_Colorimetry.m'</blackCode>. For illustration purposes, one datum of the validation data was altered so as to generate an external data validation failure - a mismatch with the ground truth data set. 
        </p>

        <h4><hr>
            verbosity = 'none' (only the validation mode is printed)
        </h4>
        
<pre><smallBlackCode>-------------------------------------------------------------------------------------
<magenta>'FAST'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'none'.
-------------------------------------------------------------------------------------</smallBlackCode>
</pre>
<pre><smallBlackCode>-------------------------------------------------------------------------------------
<magenta>'FULL'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'none'.
-------------------------------------------------------------------------------------</smallBlackCode>
</pre>

         <h4><hr>
            verbosity = 'min' (additional info: results of external validation)
        </h4>
<pre><smallBlackCode><smallGrayCode>-------------------------------------------------------------------------------------
<magenta>'FAST'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'min'.
-------------------------------------------------------------------------------------</smallGrayCode>
[  1] 'v_Colorimetry.m'
	Internal validation  : PASSED
	Run-time status      : no exception raised
	<smallRedCode>Fast validation      : FAILED against ground truth data of 15-Dec-2014 16:41:53.
	DataHash-this run    : 4ecb73260cd36626626b6362daf675ac526f7923e14148a76badf0e89f8c11d0
	DataHash-groundTruth : 21d6825974ed81bc3251a60bcacdaa9094f2a70d398ee1553a464a4dbe1be33b<ssmallRedCode>
</smallBlackCode></pre>
<pre><smallBlackCode><smallGrayCode>-------------------------------------------------------------------------------------
<magenta>'FULL'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'min'.
-------------------------------------------------------------------------------------</smallGrayCode>
[  1] 'v_Colorimetry.m'
	Internal validation  : PASSED
	Run-time status      : no exception raised
	<smallRedCode>Full validation      : FAILED against ground truth data of 15-Dec-2014 16:45:34.
	[data mismatch  1]   : Max difference between 'groundTruthData.ptbXYZs' and 'validationData.ptbXYZs' (4) is greater than the set tolerance (1.11022e-13).</smallRedCode>
</smallBlackCode></pre>

         <h4><hr>
            verbosity = 'low' (additional info: results of internal validation )
        </h4>
<pre><smallBlackCode><smallGrayCode>-------------------------------------------------------------------------------------
<magenta>'FAST'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'low'.
-------------------------------------------------------------------------------------
[  1] 'v_Colorimetry.m'
    Internal validation  : PASSED
    Run-time status      : no exception raised
    Fast validation      : FAILED against ground truth data of 15-Dec-2014 16:41:53.
    DataHash-this run    : 4ecb73260cd36626626b6362daf675ac526f7923e14148a76badf0e89f8c11d0
    DataHash-groundTruth : 21d6825974ed81bc3251a60bcacdaa9094f2a70d398ee1553a464a4dbe1be33b</smallGrayCode>
    Validation report    : 
   ***** Basic XYZ *****
   PTB-ISET AGREE for XYZ to xy (tolerance: 1e-12)
   PTB PASSES XYZ to xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to uv (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   TB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   PTB PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ISET PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ***** sRGB *****
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   PTB PASSES linear sRGB to XYZ to linear sRGB (tolerance: 1e-12)
   PTB PASSES sRGB to linear sRGB to sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for sRGB transform matrix (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to linear sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   ISET PASSES linear sRGB to sRGB to linear sRGB (tolerance: 1e-12)
   ***** Energy/Quanta *****
   PTB-ISET AGREE for energy to quanta conversion to 5 significant places (tolerance: 1e+15 quanta)
   PTB PASSES energy to quanta to energy (tolerance: 1e-12)
   ISET PASSES energy to quanta to energy (tolerance: 1e-12)
   ***** CIE Daylights *****
   PTB-ISET AGREE for for daylight (tolerance: 1e-12)
</smallBlackCode></pre>

<pre><smallBlackCode><smallGrayCode>-------------------------------------------------------------------------------------
<magenta>'FULL'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'low'.
-------------------------------------------------------------------------------------
[  1] 'v_Colorimetry.m'
    Internal validation  : PASSED
    Run-time status      : no exception raised
    Full validation      : FAILED against ground truth data of 15-Dec-2014 16:45:34.
    [data mismatch  1]   : Max difference between 'groundTruthData.ptbXYZs' and 'validationData.ptbXYZs' (4) is greater than the set tolerance (1.11022e-13).</smallGrayCode>
    Validation report    : 
   ***** Basic XYZ *****
   PTB-ISET AGREE for XYZ to xy (tolerance: 1e-12)
   PTB PASSES XYZ to xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to uv (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   TB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   PTB PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ISET PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ***** sRGB *****
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   PTB PASSES linear sRGB to XYZ to linear sRGB (tolerance: 1e-12)
   PTB PASSES sRGB to linear sRGB to sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for sRGB transform matrix (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to linear sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   ISET PASSES linear sRGB to sRGB to linear sRGB (tolerance: 1e-12)
   ***** Energy/Quanta *****
   PTB-ISET AGREE for energy to quanta conversion to 5 significant places (tolerance: 1e+15 quanta)
   PTB PASSES energy to quanta to energy (tolerance: 1e-12)
   ISET PASSES energy to quanta to energy (tolerance: 1e-12)
   ***** CIE Daylights *****
   PTB-ISET AGREE for for daylight (tolerance: 1e-12)
</smallBlackCode></pre>


         <h4>
            - verbosity = 'med' (additional info: host on which the ground truth was generated)
        </h4>
<pre><smallBlackCode><smallGrayCode>-------------------------------------------------------------------------------------
<magenta>'FAST'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'med'.
-------------------------------------------------------------------------------------
[  1] 'v_Colorimetry.m'
    Internal validation  : PASSED
    Run-time status      : no exception raised
    Fast validation      : FAILED against ground truth data of 15-Dec-2014 16:41:53.</smallGrayCode>
     > Ground truth info : manta.PSYCH.UPENN.EDU/MACI64, MATLAB 8.4.0.150421 (R2014b) by 'nicolas'
     > Local host info   :          ioneanPelagos.local, MATLAB 8.4.0.150421 (R2014b) by 'nicolas'<smallGrayCode>
    DataHash-this run    : 4ecb73260cd36626626b6362daf675ac526f7923e14148a76badf0e89f8c11d0
    DataHash-groundTruth : 21d6825974ed81bc3251a60bcacdaa9094f2a70d398ee1553a464a4dbe1be33b
    Validation report    : 
   ***** Basic XYZ *****
   PTB-ISET AGREE for XYZ to xy (tolerance: 1e-12)
   PTB PASSES XYZ to xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to uv (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   TB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   PTB PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ISET PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ***** sRGB *****
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   PTB PASSES linear sRGB to XYZ to linear sRGB (tolerance: 1e-12)
   PTB PASSES sRGB to linear sRGB to sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for sRGB transform matrix (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to linear sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   ISET PASSES linear sRGB to sRGB to linear sRGB (tolerance: 1e-12)
   ***** Energy/Quanta *****
   PTB-ISET AGREE for energy to quanta conversion to 5 significant places (tolerance: 1e+15 quanta)
   PTB PASSES energy to quanta to energy (tolerance: 1e-12)
   ISET PASSES energy to quanta to energy (tolerance: 1e-12)
   ***** CIE Daylights *****
   PTB-ISET AGREE for for daylight (tolerance: 1e-12)
</smallGrayCode></smallBlackCode></pre>

<pre><smallBlackCode><smallGrayCode>-------------------------------------------------------------------------------------
<magenta>'FULL'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'med'.
-------------------------------------------------------------------------------------
[  1] 'v_Colorimetry.m'
    Internal validation  : PASSED
    Run-time status      : no exception raised
    Full validation      : FAILED against ground truth data of 15-Dec-2014 16:45:34.</smallGrayCode>
     > Ground truth info : manta.PSYCH.UPENN.EDU/MACI64, MATLAB 8.4.0.150421 (R2014b) by 'nicolas'
     > Local host info   :          ioneanPelagos.local, MATLAB 8.4.0.150421 (R2014b) by 'nicolas'<smallGrayCode>
    [data mismatch  1]   : Max difference between 'groundTruthData.ptbXYZs' and 'validationData.ptbXYZs' (4) is greater than the set tolerance (1.11022e-13).    
   Validation report    : 
   ***** Basic XYZ *****
   PTB-ISET AGREE for XYZ to xy (tolerance: 1e-12)
   PTB PASSES XYZ to xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to uv (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   TB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   PTB PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ISET PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ***** sRGB *****
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   PTB PASSES linear sRGB to XYZ to linear sRGB (tolerance: 1e-12)
   PTB PASSES sRGB to linear sRGB to sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for sRGB transform matrix (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to linear sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   ISET PASSES linear sRGB to sRGB to linear sRGB (tolerance: 1e-12)
   ***** Energy/Quanta *****
   PTB-ISET AGREE for energy to quanta conversion to 5 significant places (tolerance: 1e+15 quanta)
   PTB PASSES energy to quanta to energy (tolerance: 1e-12)
   ISET PASSES energy to quanta to energy (tolerance: 1e-12)
   ***** CIE Daylights *****
   PTB-ISET AGREE for for daylight (tolerance: 1e-12)</smallGrayCode>
</smallBlackCode></pre>


         <h4>
            - verbosity = 'high' (additional info: in 'FULL' mode, feedback on any 'extra data')
        </h4>
<pre><smallBlackCode><smallGrayCode>-------------------------------------------------------------------------------------
<magenta>'FAST'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'high'.
-------------------------------------------------------------------------------------
[  1] 'v_Colorimetry.m'
    Internal validation  : PASSED
    Run-time status      : no exception raised
    Fast validation      : FAILED against ground truth data of 15-Dec-2014 16:41:53. 
     > Ground truth info : manta.PSYCH.UPENN.EDU/MACI64, MATLAB 8.4.0.150421 (R2014b) by 'nicolas'
     > Local host info   :          ioneanPelagos.local, MATLAB 8.4.0.150421 (R2014b) by 'nicolas' 
    DataHash-this run    : 4ecb73260cd36626626b6362daf675ac526f7923e14148a76badf0e89f8c11d0
    DataHash-groundTruth : 21d6825974ed81bc3251a60bcacdaa9094f2a70d398ee1553a464a4dbe1be33b
    Validation report    : 
   ***** Basic XYZ *****
   PTB-ISET AGREE for XYZ to xy (tolerance: 1e-12)
   PTB PASSES XYZ to xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to uv (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   TB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   PTB PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ISET PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ***** sRGB *****
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   PTB PASSES linear sRGB to XYZ to linear sRGB (tolerance: 1e-12)
   PTB PASSES sRGB to linear sRGB to sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for sRGB transform matrix (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to linear sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   ISET PASSES linear sRGB to sRGB to linear sRGB (tolerance: 1e-12)
   ***** Energy/Quanta *****
   PTB-ISET AGREE for energy to quanta conversion to 5 significant places (tolerance: 1e+15 quanta)
   PTB PASSES energy to quanta to energy (tolerance: 1e-12)
   ISET PASSES energy to quanta to energy (tolerance: 1e-12)
   ***** CIE Daylights *****
   PTB-ISET AGREE for for daylight (tolerance: 1e-12)
</smallGrayCode></smallBlackCode></pre>

<pre><smallBlackCode><smallGrayCode>-------------------------------------------------------------------------------------
<magenta>'FULL'</magenta> mode with 'catchExceptionAndContinue' hehavior and verbosity level = 'high'.
-------------------------------------------------------------------------------------
[  1] 'v_Colorimetry.m'
    Internal validation  : PASSED
    Run-time status      : no exception raised
    Full validation      : FAILED against ground truth data of 15-Dec-2014 16:45:34.
     > Ground truth info : manta.PSYCH.UPENN.EDU/MACI64, MATLAB 8.4.0.150421 (R2014b) by 'nicolas'
     > Local host info   :          ioneanPelagos.local, MATLAB 8.4.0.150421 (R2014b) by 'nicolas'
    [data mismatch  1]   : Max difference between 'groundTruthData.ptbXYZs' and 'validationData.ptbXYZs' (4) is greater than the set tolerance (1.11022e-13).</smallGrayCode>
   Note (*)             : script does not store any extra data.
   Extra data           : MATCH with extra data of 15-Dec-2014 16:45:34.<smallGrayCode>
   Validation report    : 
   ***** Basic XYZ *****
   PTB-ISET AGREE for XYZ to xy (tolerance: 1e-12)
   PTB PASSES XYZ to xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for xyY to XYZ (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to uv (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   TB-ISET AGREE for XYZ to Luv (tolerance: 1e-12)
   PTB PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ISET PASSES XYZ to Lab to XYZ (tolerance: 1e-12)
   ***** sRGB *****
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   PTB PASSES linear sRGB to XYZ to linear sRGB (tolerance: 1e-12)
   PTB PASSES sRGB to linear sRGB to sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for sRGB transform matrix (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to linear sRGB (tolerance: 1e-12)
   PTB-ISET AGREE for XYZ to sRGB (tolerance: 1e-12)
   ISET PASSES linear sRGB to sRGB to linear sRGB (tolerance: 1e-12)
   ***** Energy/Quanta *****
   PTB-ISET AGREE for energy to quanta conversion to 5 significant places (tolerance: 1e+15 quanta)
   PTB PASSES energy to quanta to energy (tolerance: 1e-12)
   ISET PASSES energy to quanta to energy (tolerance: 1e-12)
   ***** CIE Daylights *****
   PTB-ISET AGREE for for daylight (tolerance: 1e-12)</smallGrayCode>
</smallBlackCode></pre>


         <h4>
            - verbosity = 'max' (additional info: useful only for debugging the @UnitTest class)
        </h4>
<pre>
<smallBlackCode>not shown</smallBlackCode>
</pre>
        
    </body>
 
    
</html>